topTogcluster
ggsave(topTogCluster, filename="TopTogCluster_TRex.pdf", width=10, heigh=6)
ggsave(topTogcluster, filename="TopTogCluster_TRex.pdf", width=10, heigh=6)
topTog <- tophits |> rename(GeneID=X) |>
left_join(clusterID_tophits) |>
gather(key=time, value=TMEV, 2:7) |>
mutate(clusters = as.factor(clusters), clusters=fct_relevel(clusters, "3", "6", "7", "8", "2","9", "1", "5", "4")) |>
arrange(clusters) |>
group_by(time) |>
mutate(N=row_number(),
time=as.factor(time),
time=fct_relevel(time,"T0.T360", "T20.T360", "T50.T360", "T90.T360", "T120.T360", "T260.T360"))
ggplot(topTog, aes(x=time, y=N,fill=TMEV)) + geom_raster() + scale_fill_viridis_c(option="mako") + geom_point(aes(x=0, y=N, color=as.factor(clusters))) + theme_minimal() -> topTogcluster
ggsave(topTogcluster, filename="TopTogCluster_TRex.pdf", width=10, heigh=6)
ggplot(topTogcluster, aes(x=time,y=TMEV, group=GeneID)) + geom_line() + facet_wrap(.~clusters)
ggplot(topTog, aes(x=time,y=TMEV, group=GeneID)) + geom_line() + facet_wrap(.~clusters)
ggplot(rankTog, aes(x=time,y=rankMean, group=GeneID)) + geom_line() + facet_wrap(.~clusters)
ggplot(rankTog, aes(x=time,y=rankMean, group=GeneID)) + geom_path() + facet_wrap(.~clusters)
ggplot(rankTog, aes(x=time,y=rankMean, group=GeneID)) + geom_line() + facet_wrap(.~clusters)
ggplot(topTog, aes(x=time,y=TMEV, group=GeneID)) + geom_line() + facet_wrap(.~clusters, scales="free")
topTog |> filter(clusters==9)
topTog |> filter(clusters==9) |> select(GeneID) |> distinct()
topTog |> filter(clusters==9) |> ungroup() |> select(GeneID) |> distinct()
topTog |> filter(clusters==5) |> ungroup() |> select(GeneID) |> distinct()
ggplot(topTog |> filter(str_detect("Novel")==FALSE), aes(x=time, y=N,fill=TMEV)) + geom_raster() + scale_fill_viridis_c(option="mako") + geom_point(aes(x=0, y=N, color=as.factor(clusters))) + theme_minimal() -> topTogcluster
ggplot(topTog |> filter(str_detect(GeneID,"Novel")==FALSE), aes(x=time, y=N,fill=TMEV)) + geom_raster() + scale_fill_viridis_c(option="mako") + geom_point(aes(x=0, y=N, color=as.factor(clusters))) + theme_minimal() -> topTogcluster
topTogcluster
topTog <- tophits |> rename(GeneID=X) |>
filter(str_detect(GeneID, "Novel")==FALSE) |>
left_join(clusterID_tophits) |>
gather(key=time, value=TMEV, 2:7) |>
mutate(clusters = as.factor(clusters), clusters=fct_relevel(clusters, "3", "6", "7", "8", "2","9", "1", "5", "4")) |>
arrange(clusters) |>
group_by(time) |>
mutate(N=row_number(),
time=as.factor(time),
time=fct_relevel(time,"T0.T360", "T20.T360", "T50.T360", "T90.T360", "T120.T360", "T260.T360"))
ggplot(topTog, aes(x=time, y=N,fill=TMEV)) + geom_raster() + scale_fill_viridis_c(option="mako") + geom_point(aes(x=0, y=N, color=as.factor(clusters))) + theme_minimal() -> topTogcluster
topTogcluster
ggplot(topTog, aes(x=time,y=TMEV, group=GeneID)) + geom_line() + facet_wrap(.~clusters, scales="free")
rankTog <- rankMean |> rename(GeneID = X) |>
filter(str_detect(GeneID, "Novel"==FALSE)) |>
left_join(clusterID_heat |>
select(GeneID, clusters) |>
distinct()) |>
gather(key=time, value=rankMean, 2:8) |>
mutate(clusters = as.factor(clusters), clusters=fct_relevel(clusters, "1", "4", "6", "5", "7", "8", "9", "3", "2")) |>
arrange(clusters) |>
group_by(time) |>
mutate(N=row_number(),
time= as.factor(time),
time=fct_relevel(time, "T0", "T20", "T50", "T90", "T120", "T260", "T360"))
rankTog <- rankMean |> rename(GeneID = X) |>
filter(str_detect(GeneID, "Novel")==FALSE) |>
left_join(clusterID_heat |>
select(GeneID, clusters) |>
distinct()) |>
gather(key=time, value=rankMean, 2:8) |>
mutate(clusters = as.factor(clusters), clusters=fct_relevel(clusters, "1", "4", "6", "5", "7", "8", "9", "3", "2")) |>
arrange(clusters) |>
group_by(time) |>
mutate(N=row_number(),
time= as.factor(time),
time=fct_relevel(time, "T0", "T20", "T50", "T90", "T120", "T260", "T360"))
ggplot(rankTog, aes(x=time, y=N,fill=rankMean)) + geom_raster() + scale_fill_viridis_c(option="mako") + geom_point(aes(x=0, y=N, color=as.factor(clusters))) + theme_minimal() -> RankMeanCluster
RankMeanCluster
clusterID_heat <- read.delim(file.choose()) #file = trex2.Heatmap_Rank_Factors_1.clusters.txt
counts <- read.delim(file.choose()) #file = Counts.txt
clusterID_heat <- clusterID_heat  |> left_join(counts |> rename(GeneID = key)) |> filter(str_detect(GeneID, "Novel")==FALSE)
clusterID_heat <- clusterID_heat |> gather(key=sample, value=count, 3:23) |>
separate(sample, sep="_", into=c("time", "replicate"))
clusterID_heat <- clusterID_heat |> gather(key=sample, value=count, 3:23) |>
separate(sample, sep="_", into=c("time", "replicate"))
clusterID_heat <- read.delim(file.choose()) #file = trex2.Heatmap_Rank_Factors_1.clusters.txt
clusterID_heat <- clusterID_heat  |> left_join(counts |> rename(GeneID = key)) |> filter(str_detect(GeneID, "Novel")==FALSE)
View(clusterID_heat)
clusterID_heat <- clusterID_heat |> gather(key=sample, value=count, 3:23) |>
separate(sample, sep="_", into=c("time", "replicate"))
clusterID_sum <- clusterID_heat |> group_by(GeneID, time, clusters) |> summarize(MeanSignal = mean(count), MedianSignal = median(count))
clusterID_sum <- clusterID_sum |> arrange(clusters, GeneID) |> group_by(time) |> mutate(N=row_number()) |> ungroup()
clusterID_sum <- clusterID_sum |> mutate(time=as.factor(time), time=fct_relevel(time, "T0", "T20", "T50", "T90", "T120", "T260", "T360"))
clusterID_sum <- clusterID_sum |> mutate(MeanSignal_log = log(MeanSignal), MedianSignal_log = log(MedianSignal))
ggplot(clusterID_sum, aes(x=time, y=N,fill=MeanSignal_log)) + geom_raster() + scale_fill_viridis_c(option="mako") + geom_point(aes(x=0, y=N, color=as.factor(clusters))) + theme_minimal() -> MeanSignalPlot_cluster
MeanSignalPlot_cluster
RankMeanCluster
MedianSignalPlot_cluster
highfoldplot
topTogcluster
medianfoldplot
cluster_high <- read.delim(file.choose()) #using HighFold file
cluster_high <- cluster_high |> gather(key=time, value=HighFold, 2:7) |> filter(str_detect(GeneID, "Novel")==FALSE)
View(cluster_high)
cluster_high <- cluster_high |> gather(key=time, value=HighFold, 2:7) |> filter(str_detect(X, "Novel")==FALSE)
cluster_high <- cluster_high |> arrange(clusterID) |> group_by(time) |>  mutate(N = row_number())
cluster_high <- cluster_high |> mutate(time = as.factor(time))
cluster_high <- cluster_high |> mutate(time = fct_relevel(time, "T0.T360", "T20.T360", "T50.T360", "T90.T360"))
ggplot(cluster_high, aes(x=time, y=N,fill=HighFold)) + geom_raster() + scale_fill_viridis_c(option="mako") + geom_point(aes(x=0, y=N, color=as.factor(clusterID))) + theme_minimal() ->
highfoldplot
highfoldplot
clusterfile <- read.delim(file.choose()) #using MedianFold file
clusterfile <- clusterfile |> gather(key=time, value=MedianFold, 2:7) |> filter(str_detect(X,"Novel")==FALSE)
clusterfile <- clusterfile |> arrange(clusterID) |> group_by(time) |>  mutate(N = row_number())
clusterfile <- clusterfile |> mutate(time = as.factor(time))
clusterfile <- clusterfile |> mutate(time = fct_relevel(time, "T0.T360", "T20.T360", "T50.T360", "T90.T360"))
ggplot(clusterfile, aes(x=time, y=N,fill=MedianFold)) + geom_raster() + scale_fill_viridis_c(option="mako") + geom_point(aes(x=0, y=N, color=as.factor(clusterID))) + theme_minimal() -> medianfoldplot
medianfoldplot
View(clusterfile)
clusterfile <- read.delim(file.choose()) #using MedianFold file
clusterfile <- clusterfile |> gather(key=time, value=MedianFold, 2:7) |> filter(str_detect(X,"Novel")==FALSE)
clusterfile <- clusterfile |> arrange(clusterID) |> group_by(time) |>  mutate(N = row_number())
clusterfile <- clusterfile |> mutate(time = as.factor(time))
View(clusterfile)
clusterfile <- clusterfile |> mutate(time = fct_relevel(time, "T0.T360", "T20.T360", "T50.T360", "T90.T360"))
ggplot(clusterfile, aes(x=time, y=N,fill=MedianFold)) + geom_raster() + scale_fill_viridis_c(option="mako") + geom_point(aes(x=0, y=N, color=as.factor(clusterID))) + theme_minimal() -> medianfoldplot
medianfoldplot
cluster_exp <- read.delim(file.choose()) #using MeanSignal file
cluster_exp <- cluster_exp |> gather(key=time, value=MeanSignal, 2:8) |> filter(str_detect(X, "Novel")==FALSE)
cluster_exp <- cluster_exp |> arrange(clusterID) |> group_by(time) |>  mutate(N = row_number())
cluster_exp <- cluster_exp |> mutate(time = as.factor(time))
cluster_exp <- cluster_exp |> mutate(time = fct_relevel(time, "T0","T20", "T50", "T90", "T120", "T260", "T360"))
ggplot(cluster_exp, aes(x=time, y=N,fill=MeanSignal)) + geom_raster() + scale_fill_viridis_c(option="mako") + geom_point(aes(x=0, y=N, color=as.factor(clusterID))) + theme_minimal() -> meansignalplot
meansignalplot
ggplot(cluster_exp, aes(x=time, y=MeanSignal, group=X)) + geom_line() + facet_wrap(.~clusterID, scales="free")
ggplot(cluster_high, aes(x=time, y=HighFold, group=X)) + geom_line() + facet_wrap(.~clusterID, scales="free")
ggplot(clusterfile, aes(x=time, y=MedianFold, group=X)) + geom_line() + facet_wrap(.~clusterID, scales="free")
cluster_high |> filter(clusterID==10) |> select(X) |> distinct()
cluster_high |> filter(clusterID==10) |> select(X) |> ungroup() |> distinct()
cluster_high |> filter(clusterID==10) |>  ungroup() |> select(X) |> distinct()
cluster_high |> filter(clusterID==10) |>  ungroup() |> select(X) |> distinct() |> View()
View(cluster_exp)
View(clusterfile)
View(clusterID_heat)
View(goterms)
View(highfoldplot)
View(meansignalplot)
View(separate)
View(T0s_1000)
View(T360s)
annotations <- read.delim(file.choose())
View(annotations)
cluster_high <- cluster_high |> left_join(annotations |> mutate(X=gene_id))
View(cluster_high)
cluster_high |> filter(clusterID==10) |>  ungroup() |> select(X) |> distinct() |> View()
cluster_high |> filter(clusterID==10) |>  ungroup() |> select(X, gene_name, gene_description) |> distinct() |> View()
cluster_high |> filter(clusterID==1) |>  ungroup() |> select(X, gene_name, gene_description) |> distinct() |> View()
ggplot(cluster_high, aes(x=time, y=HighFold, group=X)) + geom_line() + facet_wrap(.~clusterID, scales="free")
cluster_high |> filter(clusterID==13) |>  ungroup() |> select(X, gene_name, gene_description) |> distinct() |> View()
cluster_high |> filter(clusterID==2) |>  ungroup() |> select(X, gene_name, gene_description) |> distinct() |> View()
cluster_high |> filter(clusterID==11) |>  ungroup() |> select(X, gene_name, gene_description) |> distinct() |> View()
cluster_exp <- cluster_exp |> left_join(annotations |> mutate(X=gene_id))
ggplot(cluster_exp, aes(x=time, y=HighFold, group=X)) + geom_line() + facet_wrap(.~clusterID, scales="free")
ggplot(cluster_exp, aes(x=time, y=MeanFold, group=X)) + geom_line() + facet_wrap(.~clusterID, scales="free")
ggplot(cluster_exp, aes(x=time, y=MeanSignal, group=X)) + geom_line() + facet_wrap(.~clusterID, scales="free")
cluster_exp |> filter(clusterID==18) |>  ungroup() |> select(X, gene_name, gene_description) |> distinct() |> View()
cluster_exp |> filter(clusterID==5) |>  ungroup() |> select(X, gene_name, gene_description) |> distinct() |> View()
cluster_exp |> filter(clusterID==17) |>  ungroup() |> select(X, gene_name, gene_description) |> distinct() |> View()
cluster_exp |> filter(clusterID==6) |>  ungroup() |> select(X, gene_name, gene_description) |> distinct() |> View()
clusterfile <- clusterfile |> left_join(annotations |> mutate(X=gene_id))
ggplot(clusterfile, aes(x=time, y=MeanFold, group=X)) + geom_line() + facet_wrap(.~clusterID, scales="free")
ggplot(clusterfile, aes(x=time, y=MedianFold, group=X)) + geom_line() + facet_wrap(.~clusterID, scales="free")
clusterfile |> filter(clusterID==10) |>  ungroup() |> select(X, gene_name, gene_description) |> distinct() |> View()
clusterfile |> filter(clusterID==11) |>  ungroup() |> select(X, gene_name, gene_description) |> distinct() |> View()
clusterfile |> filter(clusterID==12) |>  ungroup() |> select(X, gene_name, gene_description) |> distinct() |> View()
medianfoldplot
topTogcluster
medianfoldplot
read.csv(file.choose())
read.csv(file.choose())
horeca <- read.csv(file.choose())
library(tidyverse)
horeca |> group_by(plaats, wat) |> summarize(prijs=sum(prijs))
#get files (don't need phase)
outlines <- extr_MicrobeJ(file.choose(), cellList=TRUE)
library(bactMAP)
library(ggplot2)
#get files (don't need phase)
outlines <- extr_MicrobeJ(file.choose(), cellList=TRUE)
#add experiment ID as your file contains two experiments
outlines$mesh <- outlines$mesh |> left_join(outlines$cellList |> rename(cellID=NAME.id) |> select(cellID, experiment) |> distinct()) |> mutate(X=X/0.0499550, Y=Y/0.0499550)
library(tidyverse)
#add experiment ID as your file contains two experiments
outlines$mesh <- outlines$mesh |> left_join(outlines$cellList |> rename(cellID=NAME.id) |> select(cellID, experiment) |> distinct()) |> mutate(X=X/0.0499550, Y=Y/0.0499550)
#load fluo file
Green <- extr_OriginalStack(file.choose())
##The image you sent me is frame 4, experiment "BA-D39V-1" so I'm selecting for that here. You can adapt the selection for your real analysis
frame4 <- outlines$mesh |> filter(experiment=="BA-D39V-1", frame==4) |> mutate(frame=1)
frame4 <- frame4 |> mutate(X = X-1, Y=Y+2.5)
makeBuffer <- function(dataset, width_pixels){
dataset$unique <- paste(dataset$frame, dataset$cell, sep="_")
out <- lapply(unique(dataset$unique), function(W){
rgeos::gBuffer(sp::SpatialPointsDataFrame(coords=dataset[dataset$unique==W,][,c("X", "Y")], data=dataset[dataset$unique==W,]), width= width_pixels)@polygons[[1]]@Polygons[[1]]@coords |>
data.frame() |>
mutate(cell = unique(dataset$cell[dataset$unique==W]),
frame = unique(dataset$frame[dataset$unique==W]))
}) |>
bind_rows() |>
rename(X=x, Y=y) |>
left_join(unique(dataset[,c("cell", "frame", "area", "max.length", "max.width", "angle", "Xmid", "Ymid", "maxwum", "max_um")]))
return(out)
}
buffered <- makeBuffer(frame4, width_pixels = 0.2/0.0499550)
#take values of each cell
cellsbuffered <- extr_OriginalCells(Green, buffered, turnCell=FALSE) |> mutate(values = values - min(values))
bgbuf <- quantile(cellsbuffered$values, 0.05)
onlybuffercount <- cellsbuffered[cellsbuffered$values>bgbuf,] |> group_by(cell) |>  summarize(spotsize = n(), sd = sd(values), mean = mean(values), median=median(values), min=min(values), max=max(values))
otherone <- extr_OriginalStack(file.choose())
chains <- extr_MicrobeJ(file.choose(), cellList=TRUE)
chains$mesh <- chains$mesh |> left_join(chains$cellList |> rename(cellID=NAME.id) |> select(cellID, experiment) |> distinct()) |> mutate(X=X/0.0499550, Y=Y/0.0499550)
frame3_neg  <- chains$mesh |> filter(experiment=="neg-D39V-1", frame==3) |> mutate(frame=1)
buffered_neg <- makeBuffer(frame3_neg, width_pixels = 0.2/0.0499550)
#take values of each cell
cellsbuffered_neg <- extr_OriginalCells(otherone, buffered_neg, turnCell=FALSE) |> mutate(values = values - min(values))
bgbufneg <- quantile(cellsbuffered_neg$values, 0.05)
onlybuffercount_neg <- cellbuffered_neg[cellsbuffered_neg$values>bgbufneg,] |> group_by(cell) |>  summarize(spotsize = n(), sd = sd(values), mean = mean(values), median=median(values), min=min(values), max=max(values))
onlybuffercount_neg <- cellsbuffered_neg[cellsbuffered_neg$values>bgbufneg,] |> group_by(cell) |>  summarize(spotsize = n(), sd = sd(values), mean = mean(values), median=median(values), min=min(values), max=max(values))
## combine
tog <- combineDataframes(list(onlybuffercount, onlybuffercount_neg), list("BA-D39V-1", "neg-D39V-1"))$finalframe
ggplot(tog, aes(x=condition, y=sd)) + ggforce::geom_sina()
ggplot(tog, aes(x=condition, y=max)) + ggforce::geom_sina()
ggplot(tog, aes(x=condition, y=spotsize)) + ggforce::geom_sina()
ggplot(tog, aes(x=condition, y=sd)) + ggforce::geom_sina()
quantile(cellsbuffered_neg$values, 0.05)
quantile(cellsbuffered_neg$values)
quantile(cellsbuffered$values)
bgbuf <- quantile(cellsbuffered$values, 0.1)
onlybuffercount <- cellsbuffered[cellsbuffered$values>bgbuf,] |> group_by(cell) |>  summarize(spotsize = n(), sd = sd(values), mean = mean(values), median=median(values), min=min(values), max=max(values))
bgbufneg <- quantile(cellsbuffered_neg$values, 0.1)
onlybuffercount_neg <- cellsbuffered_neg[cellsbuffered_neg$values>bgbufneg,] |> group_by(cell) |>  summarize(spotsize = n(), sd = sd(values), mean = mean(values), median=median(values), min=min(values), max=max(values))
## combine
tog <- combineDataframes(list(onlybuffercount, onlybuffercount_neg), list("BA-D39V-1", "neg-D39V-1"))$finalframe
ggplot(tog, aes(x=condition, y=sd)) + ggforce::geom_sina()
ggplot(tog, aes(x=condition, y=max)) + ggforce::geom_sina()
ggplot(tog, aes(x=condition, y=spotsize)) + ggforce::geom_sina()
ggplot(tog, aes(x=condition, y=sd)) + ggforce::geom_sina()
ggplot(tog, aes(x=condition, y=max)) + ggforce::geom_sina()
cluster_exp <- read.delim(file.choose()) #using MeanSignal file
cluster_exp <- cluster_exp |> gather(key=time, value=MeanSignal, 2:8) |> filter(str_detect(X, "Novel")==FALSE)
library(tidyverse)
cluster_exp <- cluster_exp |> gather(key=time, value=MeanSignal, 2:8) |> filter(str_detect(X, "Novel")==FALSE)
cluster_exp <- cluster_exp |> arrange(clusterID) |> group_by(time) |>  mutate(N = row_number())
cluster_exp <- cluster_exp |> mutate(time = as.factor(time))
cluster_exp <- cluster_exp |> mutate(time = fct_relevel(time, "T0","T20", "T50", "T90", "T120", "T260", "T360"))
ggplot(cluster_exp, aes(x=time, y=N,fill=MeanSignal)) + geom_raster() + scale_fill_viridis_c(option="mako") + geom_point(aes(x=0, y=N, color=as.factor(clusterID))) + theme_minimal() -> meansignalplot
annotations <- read.delim(file.choose()) #0.Supfile->gene.xls
cluster_exp <- cluster_exp |> left_join(annotations |> mutate(X=gene_id))
cluster_exp <- cluster_exp |> group_by(time) |> arrange(time, -MeanSignal) |> mutate(rank=row_number())
ggplot(cluster_exp |> filter(rank<100), aes(x=gene_start, y=1)) +  geom_hline(yintercept=1) +geom_point(aes(color=rank), size=3) + coord_polar() + facet_grid(.~time) + theme_void() + scale_color_viridis_c(option="mako") + ylim(-1,1)
View(cluster_exp)
ggplot(cluster_exp, aes(x=time, y=MeanSignal, group=X)) + geom_line() + facet_wrap(.~clusterID) + geom_line(data=cluster_exp |> filter(X=="BD_RS01290"), color="yellow")
with_Bd0279 = cluster_exp |> filter(clusterID==9)
ggplot(cluster_exp, aes(x=time, y=MeanSignal, group=X)) + geom_line() + facet_wrap(.~clusterID) + geom_line(data=cluster_exp |> filter(X=="BD_RS08330"), color="yellow")
with_Bd1827 = cluster_exp |> filter(clusterID==11)
cogs <- read.delim(file.choose())
View(cogs)
cogs <- cogs |> rename(gene_id = locus_tag)
with_Bd0279 = cluster_exp |> filter(clusterID==9) |> left_join(cogs)
with_Bd1827 = cluster_exp |> filter(clusterID==11) |> left_join(cogs)
View(with_Bd0279)
with_Bd0279 = cluster_exp |> filter(clusterID==9) |> left_join(cogs) |> select(-time) |> distinct()
with_Bd0279 = cluster_exp |> filter(clusterID==9) |> left_join(cogs) |> select(-time) |> distinct()
View(with_Bd0278)
View(with_Bd0279)
with_Bd0279 = cluster_exp |> filter(clusterID==9) |> left_join(cogs) |> ungroup() |> select(-time) |> distinct()
with_Bd0279 = cluster_exp |> filter(clusterID==9) |> left_join(cogs) |> ungroup()
with_Bd0279 = cluster_exp |> filter(clusterID==9) |> left_join(cogs)
View(cogs)
rm(with_Bd0279)
ggplot(cluster_exp, aes(x=time, y=MeanSignal, group=X)) + geom_line() + facet_wrap(.~clusterID) + geom_line(data=cluster_exp |> filter(X=="BD_RS01290"), color="yellow")
with_Bd0279 = cluster_exp |> filter(clusterID==9) |> left_join(cogs)
ggplot(cluster_exp, aes(x=time, y=MeanSignal, group=X)) + geom_line() + facet_wrap(.~clusterID) + geom_line(data=cluster_exp |> filter(X=="BD_RS08330"), color="yellow")
with_Bd1827 = cluster_exp |> filter(clusterID==11) |> left_join(cogs)
View(with_Bd0279)
ggplot(cluster_exp, aes(x=time, y=MeanSignal, group=X)) + geom_line() + facet_wrap(.~clusterID) + geom_line(data=cluster_exp |> filter(X=="BD_RS01290"), color="yellow")
with_Bd0279 = cluster_exp |> filter(clusterID==9) |> left_join(cogs) |> ungroup() |> select(-time) |> distinct()
ggplot(cluster_exp, aes(x=time, y=MeanSignal, group=X)) + geom_line() + facet_wrap(.~clusterID) + geom_line(data=cluster_exp |> filter(X=="BD_RS08330"), color="yellow")
with_Bd1827 = cluster_exp |> filter(clusterID==11) |> left_join(cogs) |> ungroup() |> select(-time) |> distinct()
ggplot(with_Bd0279, aes(x=description)) + geom_histogram()
ggplot(with_Bd0279, aes(x=description)) + geom_histogram(stat=count())
ggplot(with_Bd0279, aes(x=description)) + geom_bar()
ggplot(with_Bd0279 |> filter(!is.na(description)), aes(x=description)) + geom_bar()
ggplot(with_Bd0279 |> filter(!is.na(description)), aes(x=description, color = description)) + geom_bar()
ggplot(with_Bd0279 |> filter(!is.na(description)), aes(x=description, fill = description)) + geom_bar()
View(with_Bd0279)
with_Bd0279 = cluster_exp |> filter(clusterID==9) |> left_join(cogs) |> ungroup() |> select(-time, rank,MeanSignal) |> distinct()
ggplot(with_Bd0279 |> filter(!is.na(description)), aes(x=description, fill = description)) + geom_bar()
View(with_Bd0279)
View(with_Bd0279)
with_Bd0279 = cluster_exp |> filter(clusterID==9) |> left_join(cogs) |> ungroup() |> select(-time, -rank,-MeanSignal) |> distinct()
View(with_Bd0279)
ggplot(with_Bd0279 |> filter(!is.na(description)), aes(x=description, fill = description)) + geom_bar()
ggplot(cluster_exp |> filter(clusterID==9), aes(x=time, y=MeanSignal, group=X)) + geom_line() + facet_wrap(.~clusterID) + geom_line(data=cluster_exp |> filter(X=="BD_RS01290"), color="yellow")
ggplot(cluster_exp |> filter(clusterID==9), aes(x=time, y=MeanSignal, group=X)) + geom_line() + facet_wrap(.~clusterID) + geom_line(data=cluster_exp |> filter(X=="BD_RS01290"), color="yellow") + theme_minimal()
ggplot(cluster_exp |> filter(clusterID==9), aes(x=time, y=MeanSignal, group=X)) + geom_line() + facet_wrap(.~clusterID) + geom_line(data=cluster_exp |> filter(X=="BD_RS01290"), color="orange", linewidth=2) + theme_minimal()
with_Bd1827 = cluster_exp |> filter(clusterID==11) |> left_join(cogs) |> ungroup() |> select(-time, -rank,-MeanSignal) |> distinct()
ggplot(with_Bd1827 |> filter(!is.na(description)), aes(x=description, fill = description)) + geom_bar()
ggplot(cluster_exp |> filter(clusterID==11), aes(x=time, y=MeanSignal, group=X)) + geom_line() + facet_wrap(.~clusterID) + geom_line(data=cluster_exp |> filter(X=="BD_RS08330"), color="orange", linewidth=2) + theme_minimal()
setwd("C:/Users/adminuser/OneDrive - UCL/Result_X204SC23012888-Z01-F004-B4/proteome_hocher")
load("MeanSignal_Gathered.Rda")
load("MeanSignals_Gathered.Rda")
prot <- read_txt("SourceData_F_2BG.txt")
prot <- read_csv("SourceData_F_2BG.txt")
prot <- readr::read_csv("SourceData_F_2BG.txt")
prot <- readr::read_csv("SourceData_F_2BG.txt", tab ="/")
prot <- read.delim("SourceData_F_2BG")
prot <- read.delim("SourceData_F_2BG.txt")
View(prot)
write.table(prot |> select(ID), file="accessions.txt", sep="/t")
library(tidyverse)
write.table(prot |> select(ID), file="accessions.txt", sep="/t")
write.table(prot |> select(ID), file="accessions.txt", sep="\t")
write_delim(prot$ID, file="accestions.txt")
write_delim(prot |> select(ID), file="accestions.txt")
View(cluster_exp)
install.packages("seqinr")
library(seqinr)
read.fasta(file.choose())
fastafile <- read.fasta(file.choose())
summary(fastafile)
fastafile[[1]]
seqinr::getAnnot.list(fastafile)
fasta_ann <- getAnnot.list(fastafile) |> rbind()
View(fasta_ann)
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> tibble()
fasta_ann[1,]
fasta_ann[1,][[1]]
View(fasta_ann[1,][[1]])
print(fasta_ann[1,][[1]])
# Sample list of strings
data <- c(
">lcl|BX842650.1_cds_CAE79567.1_1 [locus_tag=Bd1697] [db_xref=GOA:Q6MMD8,InterPro:IPR001509,InterPro:IPR016040,UniProtKB/TrEMBL:Q6MMD8] [protein=UDP-N-acetyl-D-quinovosamine 4-epimerase] [protein_id=CAE79567.1] [location=complement(241862..242731)] [gbkey=CDS]"
)
# Function to extract data from a string
extract_data <- function(string) {
matches <- str_match_all(string, "\\[([^=]+)=([^\\]]+)\\]")
if (length(matches) > 0) {
matches <- matches[[1]]
names(matches) <- NULL
return(as.data.frame(t(matches))
)} else {
return(data.frame())
}
}
# Create a list of data frames
data_frames <- lapply(data, extract_data)
data_frames
# Combine the list of data frames into one data frame
result_df <- do.call(rbind, data_frames)
# Set column names
colnames(result_df) <- c("Column_Name", "Value")
View(result_df)
colnames(fasta_ann) <- c("info")
View(fasta_ann)
fasta_ann <- getAnnot.list(fastafile)
fasta_ann <- getAnnot.list(fastafile) |> rbind()
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t()
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as.tibble()
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble()
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(string, "\\[([^=]+)=([^\\]]+)\\]"))
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]"))
View(fasta_ann)
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\([^=]+)=([^\\]]+)\\"))
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]"))
fasta_ann$test[1]
fasta_ann$test[1][[1]]
fasta_ann$test[1][[1]][,2:3]
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")[[1]][,2:3])
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")[[1]])
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]"))
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]"), test=test[[1]])
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]"), test=test[,1)
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]"), test=test[,1])
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest()
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest(cols=c(test))
View(fast_ann)
View(fasta_ann)
?unnest
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest(cols=c(test)) |> select("test[,2]", "test[,3]")
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest(cols=c(test))
colnames(fasta_ann)
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest(cols=c(test), names_sep="_")
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest_wider(cols=c(test), names_sep="_")
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest_wider( names_sep="_")
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest_wider( col = test,names_sep="_")
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]"))
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_data_frame() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]"))
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as_tibble() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]"))
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as.data.frame() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]"))
fasta_ann <- getAnnot.list(fastafile) |> rbind() |> t() |> as.data.frame() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest()
fasta_ann <- fasta_ann$test
fasta_ann <- seqinr::getAnnot.list(fastafile) |> rbind() |> t() |> as.data.frame() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest()
fasta_ann <- fasta_ann$test |> select(V2, V3)
fasta_ann <- fasta_ann$test |> as_tibble() |> select(V2, V3)
View(fasta_ann)
fasta_ann <- seqinr::getAnnot.list(fastafile) |> rbind() |> t() |> as.data.frame() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]") |> as_tibble()) |> unnest()
fasta_ann <- seqinr::getAnnot.list(fastafile) |> rbind() |> t() |> as.data.frame() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest()
fasta_ann <- fasta_ann$test |> as_tibble() |> select(V2, V3)
fasta_ann <- seqinr::getAnnot.list(fastafile) |> rbind() |> t() |> as.data.frame() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest()
fasta_ann <- fasta_ann$test |> as_tibble() |> select(V2, V3) |> spread(key=V1, value=V2)
fasta_ann <- fasta_ann$test |> as_tibble() |> select(V2, V3) |> spread(key=V2, value=V3)
fasta_ann <- seqinr::getAnnot.list(fastafile) |> rbind() |> t() |> as.data.frame() |> mutate(test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest() |> mutate(ID_number = row_number())
View(fasta_ann)
fasta_ann |> mutate(test3 = test[,3])
fasta_ann <- seqinr::getAnnot.list(fastafile) |> rbind() |> t() |> as.data.frame() |> mutate(IDnumber = row_number(), test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest() |> mutate(names = test[,2], vals = test[,3])
fasta_ann <- seqinr::getAnnot.list(fastafile) |> rbind() |> t() |> as.data.frame() |> mutate(IDnumber = row_number(), test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest(cols=test) |> mutate(names = test[,2], vals = test[,3])
View(fasta_ann)
fasta_ann <- seqinr::getAnnot.list(fastafile) |> rbind() |> t() |> as.data.frame() |> mutate(IDnumber = row_number(), test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest(cols=test) |> mutate(names = test[,2], vals = test[,3]) |> select(names, vals, IDnumber)
fasta_ann <- seqinr::getAnnot.list(fastafile) |> rbind() |> t() |> as.data.frame() |> mutate(IDnumber = row_number(), test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest(cols=test) |> mutate(names = test[,2], vals = test[,3]) |> select(names, vals, IDnumber) |> spread(key=names, values=vals)
fasta_ann <- seqinr::getAnnot.list(fastafile) |> rbind() |> t() |> as.data.frame() |> mutate(IDnumber = row_number(), test = str_match_all(V1, "\\[([^=]+)=([^\\]]+)\\]")) |> unnest(cols=test) |> mutate(names = test[,2], vals = test[,3]) |> select(names, vals, IDnumber) |> spread(key=names, value=vals)
View(prot)
prot <- read_delim("SourceData_F_2BG.txt")
View(prot)
prot <- read_delim("SourceData_F_2BG.txt") |> rename(protein_id = ID)
prot <- prot |> left_join(fasta_ann)
figS4 <- readxl::read_xlsx("Copy of SourceData_Fig_S4.xlsx")
View(figS4)
?readxl::read_xlsx
figS4 <- readxl::read_xlsx("Copy of SourceData_Fig_S4.xlsx", sheet=2)
View(figS4)
fkpm <- read_csv("gene_fkmp_group.xls")
fkpm <- read_csv("gene_fpkm_group.xls")
View(fkpm)
fkpm <- readxl::read_xls("gene_fpkm_group.xls")
fkpm <- read_delim("gene_fpkm_group.xls")
View(fkpm)
fkpm <- read_delim("gene_fpkm_group.xls") |> left_join(cluster_exp |> select(Bd, gene_id))
View(fkpm)
fkpm <- read_delim("gene_fpkm_group.xls") |> left_join(cluster_exp |> select(Bd, gene_id) |> unique())
fkpm <- read_delim("gene_fpkm_group.xls") |> left_join(cluster_exp |> select(Bd, gene_id) |> ungroup() |> unique())
View(fkpm)
fkpm <- read_delim("gene_fpkm_group.xls") |> left_join(cluster_exp |> select(Bd, gene_id) |> ungroup() |> distinct())
fkpm <- read_delim("gene_fpkm_group.xls") |> left_join(cluster_exp |> ungroup() |> select(Bd, gene_id) |> distinct())
figS4 <- figS4 |> left_join(fkpm)
View(figS4)
figS4 <- figS4 |> left_join(fkpm |> rename(locus_tag=Bd))
ggplot(figS4, aes(x=AvgLFQIntensity, y=RPKM_AP))
ggplot(figS4, aes(x=AvgLFQIntensity, y=RPKM_AP)) + geom_point()
ggplot(figS4, aes(x=AvgLFQIntensity, y=RPKM_AP)) + geom_point() + scale_x_log10() + scale_y_log10()
ggplot(figS4, aes(y=AvgLFQIntensity, x=RPKM_AP)) + geom_point() + scale_x_log10() + scale_y_log10()
ggplot(figS4, aes(y=AvgLFQIntensity, x=RPKM_GP3)) + geom_point() + scale_x_log10() + scale_y_log10()
ggplot(figS4, aes(y=AvgLFQIntensity, x=T0)) + geom_point() + scale_x_log10() + scale_y_log10()
ggplot(figS4, aes(y=AvgLFQIntensity, x=T20)) + geom_point() + scale_x_log10() + scale_y_log10()
ggplot(figS4, aes(y=AvgLFQIntensity, x=T30)) + geom_point() + scale_x_log10() + scale_y_log10()
ggplot(figS4, aes(y=AvgLFQIntensity, x=T50)) + geom_point() + scale_x_log10() + scale_y_log10()
ggplot(figS4, aes(y=AvgLFQIntensity, x=T90)) + geom_point() + scale_x_log10() + scale_y_log10()
ggplot(figS4, aes(y=AvgLFQIntensity, x=T120)) + geom_point() + scale_x_log10() + scale_y_log10()
ggplot(figS4, aes(y=AvgLFQIntensity, x=T260)) + geom_point() + scale_x_log10() + scale_y_log10()
ggplot(figS4, aes(y=AvgLFQIntensity, x=RPKM_GP3)) + geom_point() + scale_x_log10() + scale_y_log10()
ggplot(figS4, aes(y=AvgLFQIntensity, x=T260)) + geom_point() + scale_x_log10() + scale_y_log10()
ggplot(figS4, aes(y=AvgLFQIntensity, x=T260)) + geom_point() + scale_x_log10() + scale_y_log10() + geom_label(data=figs4 |> filter(gene_name=="smc"), aes(label=gene_name))
ggplot(figS4, aes(y=AvgLFQIntensity, x=T260)) + geom_point() + scale_x_log10() + scale_y_log10() + geom_label(data=figS4 |> filter(gene_name=="smc"), aes(label=gene_name))
ggplot(figS4, aes(y=AvgLFQIntensity, x=T260)) + geom_point() + scale_x_log10() + scale_y_log10() + geom_label(data=figS4 |> filter(locus_tag="Bd1158"), aes(label=locus_tag))
ggplot(figS4, aes(y=AvgLFQIntensity, x=T260)) + geom_point() + scale_x_log10() + scale_y_log10() + geom_label(data=figS4 |> filter(locus_tag=="Bd1158"), aes(label=locus_tag))
ggplot(figS4, aes(y=AvgLFQIntensity, x=T260)) + geom_point() + scale_x_log10() + scale_y_log10() + geom_label(data=figS4 |> filter(locus_tag=="Bd1158"), aes(label=locus_tag, x=AvgLFQintensity, y=T260))
ggplot(figS4, aes(y=AvgLFQIntensity, x=T260)) + geom_point() + scale_x_log10() + scale_y_log10() + geom_label(data=figS4 |> filter(locus_tag=="Bd1158"), aes(label=locus_tag, x=AvgLFQIntensity, y=T260))
ggplot(figS4, aes(y=AvgLFQIntensity, x=T260)) + geom_point() + scale_x_log10() + scale_y_log10() + geom_point(data=figS4 |> filter(locus_tag=="Bd1158"), aes( x=AvgLFQIntensity, y=T260))
ggplot(figS4, aes(y=AvgLFQIntensity, x=T260)) + geom_point() + scale_x_log10() + scale_y_log10() + geom_point(data=figS4 |> filter(locus_tag=="Bd1158"), aes( x=AvgLFQIntensity, y=T260), color="yellow")
ggplot(figS4, aes(y=AvgLFQIntensity, x=T260)) + geom_point() + scale_x_log10() + scale_y_log10() + geom_point(data=figS4 |> filter(locus_tag=="Bd0055"), aes( x=AvgLFQIntensity, y=T260), color="yellow")
ggplot(figS4, aes(y=AvgLFQIntensity, x=T260)) + geom_point() + scale_x_log10() + scale_y_log10() + geom_point(data=figS4 |> filter(locus_tag=="Bd0055"),color="yellow")
ggplot(figS4, aes(y=AvgLFQIntensity, x=T260)) + geom_point() + scale_x_log10() + scale_y_log10() + geom_label(aes(label=locus_tag))
ggplot(figS4, aes(y=AvgLFQIntensity, x=T260)) + geom_point() + scale_x_log10() + scale_y_log10() + geom_label(data=figS4 |> filter(locus_tag=="Bd0055"), aes(label=locus_tag))
prot <- read_delim("SourceData_F_2BG.txt") |> rename(protein_id = ID) |> full_join(fasta_ann)
figS4 <- readxl::read_xlsx("Copy of SourceData_Fig_S4.xlsx", sheet=2)
fkpm <- read_delim("gene_fpkm_group.xls") |> full_join(cluster_exp |> ungroup() |> select(Bd, gene_id) |> distinct())
figS4 <- figS4 |> left_join(fkpm |> rename(locus_tag=Bd))
ggplot(figS4, aes(y=AvgLFQIntensity, x=T260)) + geom_point() + scale_x_log10() + scale_y_log10() + geom_label(data=figS4 |> filter(locus_tag=="Bd1158"), aes(label=locus_tag))
figS4 |> filter(locus_tag=="Bd1158")
cluster_exp |> filter(Bd=="Bd1158")
figS4 <- figS4 |> full_join(fkpm |> rename(locus_tag=Bd))
figS4 <- readxl::read_xlsx("Copy of SourceData_Fig_S4.xlsx", sheet=2)
fkpm <- read_delim("gene_fpkm_group.xls") |> full_join(cluster_exp |> ungroup() |> select(Bd, gene_id) |> distinct())
figS4 <- figS4 |> full_join(fkpm |> rename(locus_tag=Bd))
figS4 |> filter(locus_tag=="Bd1158")
ggplot(figS4, aes(y=AvgLFQIntensity, x=T360)) + geom_point() + scale_x_log10() + scale_y_log10()
?gather
figS4 <- readxl::read_xlsx("Copy of SourceData_Fig_S4.xlsx", sheet=2)
fkpm <- read_delim("gene_fpkm_group.xls") |> full_join(cluster_exp |> ungroup() |> select(Bd, gene_id) |> distinct())
ggplot(figS4, aes(y=AvgLFQIntensity, x=fkpm)) + geom_point() + scale_x_log10() + scale_y_log10() + facet_wrap(.~time)
View(figS4)
figS4 <- readxl::read_xlsx("Copy of SourceData_Fig_S4.xlsx", sheet=2)
fkpm <- read_delim("gene_fpkm_group.xls") |> full_join(cluster_exp |> ungroup() |> select(Bd, gene_id) |> distinct())
figS4 <- figS4 |> full_join(fkpm |> rename(locus_tag=Bd)) |> gather(key="time", value="fkpm", T0, T20, T50, T90, T120, T260, T360)
figS4 <- readxl::read_xlsx("Copy of SourceData_Fig_S4.xlsx", sheet=2)
fkpm <- read_delim("gene_fpkm_group.xls") |> full_join(cluster_exp |> ungroup() |> select(Bd, gene_id) |> distinct())
ggplot(figS4, aes(y=AvgLFQIntensity, x=fkpm)) + geom_point() + scale_x_log10() + scale_y_log10() + facet_wrap(.~time)
View(figS4)
figS4 <- figS4 |> full_join(fkpm |> rename(locus_tag=Bd) |> select(locus_tag, gene_name, T0, T20, T50, T90, T120, T260, T360))  |> gather(key="time", value="fkpm", T0, T20, T50, T90, T120, T260, T360)
ggplot(figS4, aes(y=AvgLFQIntensity, x=fkpm)) + geom_point() + scale_x_log10() + scale_y_log10() + facet_wrap(.~time)
ggplot(figS4, aes(y=AvgLFQIntensity, x=fkpm)) + geom_point() + scale_x_log10() + scale_y_log10() + facet_wrap(.~time)
ggplot(figS4, aes(y=AvgLFQIntensity, x=fkpm)) + geom_point(alpha=0.5) + scale_x_log10() + scale_y_log10() + facet_wrap(.~time) + theme_minimal()
ggplot(figS4, aes(y=AvgLFQIntensity, x=fkpm)) + geom_point(alpha=0.5) + scale_x_log10() + scale_y_log10() + facet_wrap(.~time) + theme_minimal() + geom_smooth(stat="lm", se=FALSE, color="magenta")
ggplot(figS4, aes(y=AvgLFQIntensity, x=fkpm)) + geom_point(alpha=0.5) + scale_x_log10() + scale_y_log10() + facet_wrap(.~time) + theme_minimal() + geom_smooth(method="lm", se=FALSE, color="magenta")
ggplot(figS4, aes(y=AvgLFQIntensity, x=fkpm)) + geom_point(alpha=0.5) + scale_x_log10() + scale_y_log10() + facet_wrap(.~time) + theme_minimal() + geom_smooth(method="lm", se=FALSE, color="magenta") -> protein_vsRNA
ggsave(protein_vsRNA, filename="proteinvsRNA.pdf", width=10, height=9)
ggplot(figS4, aes(y=AvgLFQIntensity, x=fkpm)) + geom_point(alpha=0.5, size=0.5) + scale_x_log10() + scale_y_log10() + facet_wrap(.~time) + theme_minimal() + geom_smooth(method="lm", se=FALSE, color="magenta") -> protein_vsRNA
ggsave(protein_vsRNA, filename="proteinvsRNA.pdf", width=10, height=9)
ggplot(figS4, aes(y=AvgLFQIntensity, x=fkpm)) + geom_point(alpha=0.5, size=0.5) + scale_x_log10() + scale_y_log10() + facet_wrap(.~time) + theme_minimal() + geom_smooth(method="lm", se=FALSE, color="magenta") + geom_point(data=figS4 |> filter(locus_tag="Bd3905", color="yellow"))
ggplot(figS4, aes(y=AvgLFQIntensity, x=fkpm)) + geom_point(alpha=0.5, size=0.5) + scale_x_log10() + scale_y_log10() + facet_wrap(.~time) + theme_minimal() + geom_smooth(method="lm", se=FALSE, color="magenta") + geom_point(data=figS4 |> filter(locus_tag=="Bd3905", color="yellow"))
ggplot(figS4, aes(y=AvgLFQIntensity, x=fkpm)) + geom_point(alpha=0.5, size=0.5) + scale_x_log10() + scale_y_log10() + facet_wrap(.~time) + theme_minimal() + geom_smooth(method="lm", se=FALSE, color="magenta") + geom_point(data=figS4 |> filter(locus_tag=="Bd3905"), color="yellow")
ggplot(figS4, aes(y=AvgLFQIntensity, x=fkpm)) + geom_point(alpha=0.5, size=0.5) + scale_x_log10() + scale_y_log10() + facet_wrap(.~time) + theme_minimal() + geom_smooth(method="lm", se=FALSE, color="magenta") + geom_point(data=figS4 |> filter(locus_tag=="Bd3905"), color="yellow", size=3)
ggplot(figS4, aes(y=AvgLFQIntensity, x=fkpm)) + geom_point(alpha=0.5, size=0.5) + scale_x_log10() + scale_y_log10() + facet_wrap(.~time) + theme_minimal() + geom_smooth(method="lm", se=FALSE, color="magenta") + geom_point(data=figS4 |> filter(locus_tag=="Bd0055"), color="yellow", size=3)
ggplot(figS4 |> mutate(time=fct_relevel(time, "T0","T20", "T50", "T90","T120","T260")), aes(y=AvgLFQIntensity, x=fkpm)) + geom_hex() + scale_x_log10() + scale_y_log10() + facet_wrap(.~time) + theme_classic() + geom_smooth(method="lm", sd=NA, color="black") + scale_fill_gradient(low="#FFE5E5",high="red") + xlab("RNA seq FPKM / gene") + ylab("Proteome average FQ Intensity per gene") -> plotallcors
library(tidyverse)
ggplot(figS4 |> mutate(time=fct_relevel(time, "T0","T20", "T50", "T90","T120","T260")), aes(y=AvgLFQIntensity, x=fkpm)) + geom_hex() + scale_x_log10() + scale_y_log10() + facet_wrap(.~time) + theme_classic() + geom_smooth(method="lm", sd=NA, color="black") + scale_fill_gradient(low="#FFE5E5",high="red") + xlab("RNA seq FPKM / gene") + ylab("Proteome average FQ Intensity per gene") -> plotallcors
ggsave(plotallcors, filename="plotallcors.pdf", width=10,height=10)
lapply(figS4$time |> distinct(), function(x){figS4 |> filter(time==x) |> select(AvgLFQIntensity, fkpm) |> cor()})
lapply(figS4$time |> unique(), function(x){figS4 |> filter(time==x) |> select(AvgLFQIntensity, fkpm) |> cor()})
View(figS4)
lapply(figS4$time |> unique(), function(x){figS4 |> filter(time==x, !is.na(AvgLFQIntensity, !is.na(fkpm))) |> select(AvgLFQIntensity, fkpm) |> cor()})
lapply(figS4$time |> unique(), function(x){figS4 |> filter(time==x, !is.na(AvgLFQIntensity), !is.na(fkpm)) |> select(AvgLFQIntensity, fkpm) |> cor()})
lapply(figS4$time |> unique(), function(x){print(x) figS4 |> filter(time==x, !is.na(AvgLFQIntensity), !is.na(fkpm)) |> select(AvgLFQIntensity, fkpm) |> cor()})
lapply(figS4$time |> unique(), function(x){print(x)
figS4 |> filter(time==x, !is.na(AvgLFQIntensity), !is.na(fkpm)) |> select(AvgLFQIntensity, fkpm) |> cor()})
